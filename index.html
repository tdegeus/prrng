<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>prrng: prrng</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">prrng<span id="projectnumber">&#160;1.12.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">prrng </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2home_2runner_2work_2prrng_2prrng_2README"></a> <a href="https://github.com/tdegeus/prrng/actions"><img src="https://github.com/tdegeus/prrng/workflows/CI/badge.svg" alt="CI" style="pointer-events: none;" class="inline"/></a> <a href="https://tdegeus.github.io/prrng"><img src="https://github.com/tdegeus/prrng/workflows/gh-pages/badge.svg" alt="Doxygen -> gh-pages" style="pointer-events: none;" class="inline"/></a> <a href="https://anaconda.org/conda-forge/prrng"><img src="https://img.shields.io/conda/vn/conda-forge/prrng.svg" alt="Conda Version" style="pointer-events: none;" class="inline"/></a> <a href="https://anaconda.org/conda-forge/python-prrng"><img src="https://img.shields.io/conda/vn/conda-forge/python-prrng.svg" alt="Conda Version" style="pointer-events: none;" class="inline"/></a></p>
<p>Portable Reconstructible (Pseudo) Random Number Generator.</p>
<p>Documentation: <a href="https://tdegeus.github.io/prrng">https://tdegeus.github.io/prrng</a></p>
<h2><a class="anchor" id="autotoc_md1"></a>
Credits</h2>
<p>This library is a wrapper around <a href="https://github.com/imneme/pcg-c-basic">imneme/pcg-c-basic</a>, see also <a href="http://www.pcg-random.org">pcg-random.org</a>, and uses some features from <a href="https://github.com/wjakob/pcg32">wjakob/pcg32</a>.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Basic example</h2>
<p>The idea is to provide a random number generator that can return nd-distributions of random numbers. Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;ctime&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;xtensor/xtensor.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="prrng_8h.html">prrng.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> seed = std::time(0);</div>
<div class="line">    <a class="code hl_class" href="classprrng_1_1pcg32.html">prrng::pcg32</a> generator(seed);</div>
<div class="line">    <span class="keyword">auto</span> a = generator.random({10, 40});</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassprrng_1_1pcg32_html"><div class="ttname"><a href="classprrng_1_1pcg32.html">prrng::pcg32</a></div><div class="ttdoc">Random number generate using the pcg32 algorithm.</div><div class="ttdef"><b>Definition</b> <a href="prrng_8h_source.html#l02873">prrng.h:2873</a></div></div>
<div class="ttc" id="aprrng_8h_html"><div class="ttname"><a href="prrng_8h.html">prrng.h</a></div><div class="ttdoc">Portable Reconstructible Random Number Generator.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md3"></a>
pcg32</h2>
<p>One of the hallmark features of the pcg32 generator is that the state of the random generator (the position in random sequence set by the seed) can be saved and restored at any point</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;xtensor/xtensor.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="prrng_8h.html">prrng.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="classprrng_1_1pcg32.html">prrng::pcg32</a> generator();</div>
<div class="line">    <span class="keyword">auto</span> state = generator.state();</div>
<div class="line">    <span class="keyword">auto</span> a = generator.random({10, 40});</div>
<div class="line">    generator.restore(state);</div>
<div class="line">    <span class="keyword">auto</span> b = generator.random({10, 40});</div>
<div class="line">    assert(xt::allclose(a, b));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>or in Python</p>
<div class="fragment"><div class="line"><span class="keyword">import</span> prrng</div>
<div class="line"><span class="keyword">import</span> time</div>
<div class="line"> </div>
<div class="line">seed = int(time.time())</div>
<div class="line">generator = <a class="code hl_class" href="classprrng_1_1pcg32.html">prrng.pcg32</a>(seed)</div>
<div class="line">a = generator.random([10, 40])</div>
</div><!-- fragment --><p>Note that a seed gives the exact same random sequence from C++ as from Python.</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Features</h3>
<ul>
<li>Language and platform independence.</li>
<li>Several distributions implemented.</li>
<li>Advance by <code>n</code> in the random sequence in a less costly way that drawing the numbers.</li>
<li>Compute the distance between two states.</li>
</ul>
<p><b>Important (C++):</b> A very important and hallmark features of pcg32 is that, internally, types of fixed bit size are used. Notably the state is (re)stored as <code>uint64_t</code>. This makes that restoring can be uniquely done on any system and any compiler, on any platform (as long as you save the <code>uint64_t</code> properly, naturally). As a convenience the output can be recast by specifying a template parameter, while static assertions shield you from losing data. For example, <code>auto state = generator.state&lt;size_t&gt;();</code> would be allowed, but <code>auto state = generator.state&lt;int&gt;();</code> would not.</p>
<p>Note that the Python API ensure the right types at all times.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
cumsum</h2>
<p>The advantage of being able to restore and advance the random number generator is exploited in a wrapper in which the cumulative sum of the sequence of random numbers can be accessed in chunks.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
Basic usage</h3>
<p>For example (Python): </p><div class="fragment"><div class="line">k = 2</div>
<div class="line">scale = 5</div>
<div class="line">offset = 0.1</div>
<div class="line">generator = <a class="code hl_class" href="classprrng_1_1pcg32.html">prrng.pcg32</a>()</div>
<div class="line">x = np.cumsum(offset + generator.weibull([10000], k, scale))</div>
</div><!-- fragment --><p> The sequence <code>x</code> can potentially be very long, and one might want to access it in chunks. This can be done using: </p><div class="fragment"><div class="line">k = 2</div>
<div class="line">scale = 5</div>
<div class="line">offset = 0.1</div>
<div class="line">nchunk = 100</div>
<div class="line"> </div>
<div class="line"><span class="comment"># initialise the generator, allocate the chunk</span></div>
<div class="line">chunk = <a class="code hl_class" href="classprrng_1_1pcg32__cumsum.html">prrng.pcg32_cumsum</a>(</div>
<div class="line">    shape = [nchunk],</div>
<div class="line">    distribution = prrng.weibull,</div>
<div class="line">    parameters = [k, scale, offset],</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># access the sequence at some location</span></div>
<div class="line"><span class="comment"># if the target is far away, this can be costly</span></div>
<div class="line"><span class="comment"># (especially if the target is &#39;left&#39; of the chunk)</span></div>
<div class="line">target = 12345.6</div>
<div class="line">chunk.align(target)</div>
<div class="ttc" id="aclassprrng_1_1pcg32__cumsum_html"><div class="ttname"><a href="classprrng_1_1pcg32__cumsum.html">prrng::pcg32_cumsum</a></div><div class="ttdoc">Generator of a random cumulative sum of which a chunk is kept in memory.</div><div class="ttdef"><b>Definition</b> <a href="prrng_8h_source.html#l03504">prrng.h:3504</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md7"></a>
Customisation</h3>
<p>You can modify the sequence by modifying the chunk. For example, to apply an offset: </p><div class="fragment"><div class="line">chunk = <a class="code hl_class" href="classprrng_1_1pcg32__cumsum.html">prrng.pcg32_cumsum</a>(</div>
<div class="line">    shape = [nchunk],</div>
<div class="line">    distribution = prrng.weibull,</div>
<div class="line">    parameters = [k, scale, offset],</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">chunk -= dx0</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Array of tensors</h2>
<p>In addition a bunch of random number generators can be collected in an nd-array, such that a composite array of random numbers is returned. Example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;xtensor/xtensor.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="prrng_8h.html">prrng.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">    xt::xtensor&lt;uint64_t, 2&gt; seed = {{0, 1, 2}, {3, 4, 5}};</div>
<div class="line">    <a class="code hl_class" href="classprrng_1_1pcg32__array.html">prrng::pcg32_array</a> generator(seed);</div>
<div class="line">    <span class="keyword">auto</span> state = generator.state();</div>
<div class="line">    <span class="keyword">auto</span> a = generator.random({4, 5}); <span class="comment">// shape {2, 3, 4, 5}</span></div>
<div class="line">    generator.restore(state);</div>
<div class="line">    <span class="keyword">auto</span> b = generator.random({4, 5});</div>
<div class="line">    assert(xt::allclose(a, b));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aclassprrng_1_1pcg32__array_html"><div class="ttname"><a href="classprrng_1_1pcg32__array.html">prrng::pcg32_array</a></div><div class="ttdoc">Array of independent generators.</div><div class="ttdef"><b>Definition</b> <a href="prrng_8h_source.html#l05558">prrng.h:5558</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md9"></a>
Random distributions</h2>
<p>Each random generator can return a random sequence according to a certain distribution. The most basic behaviour is to just convert a random integer to a random double <code>[0, 1]</code>, as was already done in the examples using <code>generator.random&lt;...&gt;(...)</code>. Also this feature is included in the Python API, allowing to get a reproducible distribution.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
More information</h2>
<ul>
<li>The documentation of the code.</li>
<li>The code itself.</li>
<li>The unit tests, under <a href="./tests">tests</a>.</li>
<li>The examples, under <a href="./examples">examples</a>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Implementation</h1>
<h2><a class="anchor" id="autotoc_md12"></a>
C++ and Python</h2>
<p>The code is a C++ header-only library, but a Python module is also provided. The interfaces are identical except:</p>
<ul>
<li>All <em>xtensor</em> objects (<code>xt::xtensor&lt;...&gt;</code>) are <em>NumPy</em> arrays in Python.</li>
<li>All <code>::</code> in C++ are <code>.</code> in Python.</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
Installation</h2>
<h3><a class="anchor" id="autotoc_md14"></a>
C++ headers</h3>
<h4><a class="anchor" id="autotoc_md15"></a>
Using conda</h4>
<div class="fragment"><div class="line">conda install -c conda-forge prrng</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md16"></a>
From source</h4>
<div class="fragment"><div class="line"># Download prrng</div>
<div class="line">git checkout https://github.com/tdegeus/prrng.git</div>
<div class="line">cd prrng</div>
<div class="line"> </div>
<div class="line"># Install headers, CMake and pkg-config support</div>
<div class="line">cmake .</div>
<div class="line">make install</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md17"></a>
Python module</h3>
<h4><a class="anchor" id="autotoc_md18"></a>
Using conda</h4>
<div class="fragment"><div class="line">conda install -c conda-forge python-prrng</div>
</div><!-- fragment --><p>Note that <em>xsimd</em> and hardware optimisation are <b>not enabled</b>. To enable them you have to compile on your system, as is discussed next.</p>
<h4><a class="anchor" id="autotoc_md19"></a>
From source</h4>
<div class="fragment"><div class="line"># Download prrng</div>
<div class="line">git checkout https://github.com/tdegeus/prrng.git</div>
<div class="line">cd prrng</div>
<div class="line"> </div>
<div class="line"># Get prerequisites. An example is given using conda, but there are many other ways</div>
<div class="line">conda activate myenv</div>
<div class="line">conda env update --file environment.yaml</div>
<div class="line"># (if you use hardware optimisation, below, you also want)</div>
<div class="line">conda install -c conda-forge xsimd</div>
<div class="line"> </div>
<div class="line"># Compile and install the Python module</div>
<div class="line"># (-v can be omitted as is controls just the verbosity)</div>
<div class="line">python -m pip install . -v</div>
<div class="line"> </div>
<div class="line"># Or, compile with hardware optimisation (fastest), see scikit-build docs</div>
<div class="line">SKBUILD_CONFIGURE_OPTIONS=&quot;-DUSE_SIMD=1&quot; python -m pip install . -v</div>
<div class="line"> </div>
<div class="line"># Note that you can also compile with debug assertions (very slow)</div>
<div class="line">SKBUILD_CONFIGURE_OPTIONS=&quot;-USE_DEBUG=1&quot; python -m pip install . -v</div>
<div class="line"> </div>
<div class="line"># Or, without any assertions (slightly faster, but more dangerous)</div>
<div class="line">SKBUILD_CONFIGURE_OPTIONS=&quot;-USE_ASSERT=1&quot; python -m pip install . -v</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md20"></a>
Compiling user code</h2>
<h3><a class="anchor" id="autotoc_md21"></a>
Using CMake</h3>
<h4><a class="anchor" id="autotoc_md22"></a>
Example</h4>
<p>Using <em>prrng</em> your <code>CMakeLists.txt</code> can be as follows</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.1)</div>
<div class="line">project(example)</div>
<div class="line">find_package(prrng REQUIRED)</div>
<div class="line">add_executable(example example.cpp)</div>
<div class="line">target_link_libraries(example PRIVATE prrng)</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md23"></a>
Targets</h4>
<p>The following targets are available:</p>
<ul>
<li><code>prrng</code> Includes <em>prrng</em> and the <em>xtensor</em> dependency.</li>
<li><code>prrng::assert</code> Enables assertions by defining <code>QPOT_ENABLE_ASSERT</code>.</li>
<li><code>prrng::debug</code> Enables all assertions by defining <code>QPOT_ENABLE_ASSERT</code> and <code>XTENSOR_ENABLE_ASSERT</code>.</li>
<li><code>prrng::compiler_warings</code> Enables compiler warnings (generic).</li>
</ul>
<h4><a class="anchor" id="autotoc_md24"></a>
Optimisation</h4>
<p>It is advised to think about compiler optimisation and enabling <em>xsimd</em>. Using <em>CMake</em> this can be done using the <code>xtensor::optimize</code> and <code>xtensor::use_xsimd</code> targets. The above example then becomes:</p>
<div class="fragment"><div class="line">cmake_minimum_required(VERSION 3.1)</div>
<div class="line">project(example)</div>
<div class="line">find_package(prrng REQUIRED)</div>
<div class="line">find_package(xtensor REQUIRED)</div>
<div class="line">find_package(xsimd REQUIRED)</div>
<div class="line">add_executable(example example.cpp)</div>
<div class="line">target_link_libraries(example PRIVATE</div>
<div class="line">    prrng</div>
<div class="line">    xtensor::optimize</div>
<div class="line">    xtensor::use_xsimd)</div>
</div><!-- fragment --><p>See the <a href="https://xtensor.readthedocs.io/en/latest/">documentation of xtensor</a> concerning optimisation.</p>
<h3><a class="anchor" id="autotoc_md25"></a>
By hand</h3>
<p>Presuming that the compiler is <code>c++</code>, compile using:</p>
<div class="fragment"><div class="line">c++ -I/path/to/prrng/include ...</div>
</div><!-- fragment --><p>Note that you have to take care of the <em>xtensor</em> dependency, the C++ version, optimisation, enabling <em>xsimd</em>, ...</p>
<h3><a class="anchor" id="autotoc_md26"></a>
Using pkg-config</h3>
<p>Presuming that the compiler is <code>c++</code>, compile using:</p>
<div class="fragment"><div class="line">c++ `pkg-config --cflags prrng` ...</div>
</div><!-- fragment --><p>Note that you have to take care of the <em>xtensor</em> dependency, the C++ version, optimization, enabling <em>xsimd</em>, ...</p>
<h1><a class="anchor" id="autotoc_md27"></a>
Change-log</h1>
<h2><a class="anchor" id="autotoc_md28"></a>
v1.2.0</h2>
<h3><a class="anchor" id="autotoc_md29"></a>
New features</h3>
<ul>
<li>Allow scalar return type where possible</li>
<li>Adding <code>randint</code></li>
<li>Adding <code>delta</code> distribution (just to provide a quick API)</li>
<li>[docs] Using default doxygen theme</li>
</ul>
<h3><a class="anchor" id="autotoc_md30"></a>
Internal changes</h3>
<ul>
<li>Making <code>normal_distribution::quantile</code> more robust</li>
<li>Omitting unneeded <code>is_xtensor</code></li>
<li>[tests] Updating catch2 v3</li>
</ul>
<h2><a class="anchor" id="autotoc_md31"></a>
v0.6.1</h2>
<ul>
<li>Switching to scikit-build, clean-up of CMake (#24)</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
v0.6.0</h2>
<ul>
<li>[Python] setup.py: support cross-compilation, allowing customization</li>
<li>[CMake] allowing simd</li>
<li>[CMake] Avoiding setuptools_scm dependency if SETUPTOOLS_SCM_PRETEND_VERSION is defined</li>
<li>[CI] Minor updates</li>
<li>[docs] Updating doxystyle</li>
<li>[docs] Building docs on release</li>
<li>Using new operators xtensor</li>
<li>Minor style update</li>
<li>Fixing weibull_distribution::cdf. Plotting CDF</li>
<li>[CMake] Minor updates </li>
</ul>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
